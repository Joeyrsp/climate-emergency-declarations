{% extends "govtrack/base.html" %}
{% load humanize %}

{% block title %}Governments that have declared a Climate Emergency{% endblock %}

{% block content %}
{% if countries %}
    <table>
      <tr>
        <th class='th-index'>Government</th>
        <th class='th-index'>Population</th>
        <th class='th-index'>Date of Declaration</th>
        <!--
        <th class='th-index'>Is counted?</th>
        -->
      </tr>
    {% for country, dlist in countries %}
        <tr class='country-subhead'><th class='th-index' colspan='4'>
            {% if user.is_authenticated %}
            <a href="{% url 'country' country.id %}">{{ country.name }}</a>
            {% else %}
            {{country.name}}
            {% endif %}
        </th></tr>
        {% for dec in dlist %}
        <tr>
        <td class='td-index'>
            <a href="{% url 'node' dec.node.id %}">{{ dec.node.name }}</a>
        </td>
        <td class='td-index' align='right'>
            {% if dec.node.is_counted %}
            {{ dec.node.population | intcomma}}
            {% else %}
            <i>{{ dec.node.population | intcomma}}</i>
            {% endif %}
            </td>
        <td class='td-index'>{{ dec.display_date_declared }}</td>
        <!--
        <td class='td-index'>{{ dec.is_counted }}</td>
        -->
        </tr>
        {% endfor %}
        <tr class='country-total'>
          <td class='td-index'>Total: {{ country.num_nodes }}</td>
          <td class='td-index' align='right'>{{ country.declared_population | intcomma }}</td>
          <td></td>
        </tr>
    <tr><td>&nbsp;</td></tr>
    {% endfor %}
    </table>
{% else %}
    <p>No declarations found.</p>
{% endif %}
{% endblock %}
